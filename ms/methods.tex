% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12pt,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{xr}
\usepackage[default]{sourcesanspro}
\usepackage{sourcecodepro}
\usepackage{lineno}
\linenumbers
\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Fig.}
\else
  \newcommand\figurename{Fig.}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, enhanced, breakable, borderline west={3pt}{0pt}{shadecolor}, interior hidden, frame hidden, boxrule=0pt]}{\end{tcolorbox}}\fi
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\author{}
\date{}

\begin{document}
\hypertarget{survival-models}{%
\section{Survival models}\label{survival-models}}

We first modeled seedling survival at the individual level to check
whether neighbor densities have different effects between the dry and
rainy seasons and whether phylogenetic-weighted neighbor densities
affect seedling survival differently compared to the heterospecific
neighbor densities. We found strong positive correlations between
heterospecific neighbor densities and phylogenetic-weighted neighbor
densities (Figure S5), and thus, the effects of phylogenetic-weighted
neighbor densities and hegerospecific neighbor on seedling survival were
comparable (Table S1). We also detected seasonal interactions with
neighbor densities (Table S1). Based on these findings, we will
hereafter focus on heterospecific neighbor density in our subsequent
trait-mediated survival models for each season separately. These
preliminary models also incorporated a scaling parameter \emph{c} to
account for non-linear effects on a logistic scale (see below).

\hypertarget{traits-and-abundance-mediate-survival-models}{%
\section{Traits and abundance mediate survival
models}\label{traits-and-abundance-mediate-survival-models}}

Since the effect of tree neighbors on seedling survival is nonlinear on
a logistic scale (\protect\hyperlink{ref-Detto2019}{Detto \emph{et al.}
2019}), we performed a grid-search for the scaling parameter \emph{c}
between 0 and 1 in 0.01 increments that maximized the likelihood of the
following survival model,

\[
\mathrm{logit}(p_i) = b_0 + b_1 Z_{1i}^c + b_2 Z_{2i}^c,
\]

where \(p_i\) is the survival probability of the \emph{i}th individual,
and \(Z_1\) and \(Z_2\) are distance-weighted sums of basal areas of
conspecifics and heterospecifics respectively. We found the best
estimates of \emph{c} to be 0.27 for the dry season, 0.24 for the rainy
season, and 0.26 for the combined analysis of both seasons (Fig. S1).

We built Bayesian hierarchical models that include variation among
species in the effects of conspecific and heterospecific neighbours, and
rainfall on survival. Survival (\(s\)) of seedling record \emph{i} of
individual \emph{m} for species \emph{j} in census \emph{t} in plot
\emph{p} in seedling station \emph{s} was modeled using the Bernoulli
distribution (\(\mathcal{B}\)):

\[
s_{i,j,m,s,t,p} \sim \mathcal{B}(p_{i,j,m,s,t,p}),
\]

\[
\mathrm{logit}(p_{i,j,m,s,t,p}) = \boldsymbol{x_{i}} \cdot \boldsymbol{\beta_{j}} + \eta_m + \phi_s + \psi_p + \xi_t,
\]

where
\(\boldsymbol{\beta_{j}} = \left[\beta_{1,j}, \beta_{2,j}, \ldots, \beta_{K,j} \right]\)
is the coefficient row \emph{K}-vector for species \emph{j}, \emph{K} is
the number of predictors for an individual seedling,
\(\boldsymbol{x_i} = \left[x_{i,1},x _{i,2}, \ldots,x_{i,K} \right]\) is
the vector of predictors of size \emph{K} for an individual seedling,
\(\eta_m\) is the random effect for seedling individual, \(\phi_s\) is
the random effect for seedling plots, \(\psi_p\) is the random effect
for seedling stations, and \(\xi_t\) is the random effect for different
censuses (note that \(\cdot\) denotes dot product). The set of predictor
variables (\(\boldsymbol{x_i}\)) includes intercepts, log of seedling
heights, rainfall, densities of conspecific (\emph{ConS}) and
heterospecific (\emph{HetS}) seedlings, densities of conspecific
(\emph{ConA}) and heterospecific (\emph{HetA}) trees that are scaled by
0.27 for the dry season or 0.24 for the rainy season, and the
interactions of rains with \emph{ConS}, with \emph{HetS}, with
\emph{ConA} and with \emph{HetA}. We also considered models with
phylogenetic density effects instead of heterospecific density effects.

In the species-level regression, the coefficients
(\(\boldsymbol{\beta_{1-K}}\)) of each species \emph{j} were assumed to
have a multivariate normal distribution,

\[
\boldsymbol{\beta_j} = \boldsymbol{\gamma_k} \cdot \boldsymbol{u_j} + \Sigma,
\]

where
\(\boldsymbol{u_{j}} = \left[u_{1,j}, u_{2,j}, \ldots, u_{L,j} \right]\)
is the row vector of predictors of size \emph{L} for species \emph{j},
with \emph{L} indicaiting the number of predictors for each species,
including an intercept. The
\(\boldsymbol{\gamma_k} = \left[\gamma_{k,1}, \gamma_{k,2}, \ldots, \gamma_{k,L} \right]\)
is the coefficient \emph{L}-vector for \emph{k}th predictor in the
individual-level regression, and \(\Sigma\) represents the covariance
matrix of the coefficients. We modeled four different sets of
species-level predictors separately. The set of species-level predictor
variables (\(\boldsymbol{u_j}\)) includes 1) leaf and stem traits (
LDMC, SDMC, LA, SLA, LT, \(\delta\)C\textsubscript{13}, C, N, and
\(\pi\)\textsubscript{tlp}), 2) principal components of the traits (PC1
and PC2), 3) abundance (number of individuals), and 4) basal area. The
row vector \(\gamma_{k,1}\) represents the average effects of each
individual-level predictor (e.g., \emph{ConS}) across species, whereas
\(\gamma_{k, l}\) (\(l \ne 1\)), represents the effects of the
\emph{l}-th individual-level predictor (e.g., SLA) on the variation in
the strength of each individual-level predictor (e.g., variation in the
strength of \emph{ConS} among species). To allow comparisons among
parameter estimates, the individual-level predictors
(\(\boldsymbol{x_i}\)) and the species-level predictors
(\(\boldsymbol{u_j}\)) were scaled to a mean of 0 and standard deviation
of 1 within each season and across species, respectively. The complete
statistical details, including the Cholesky factorization and prior
information, are provided in Appendix S1.

Posterior distributions of all parameters were estimated using the
No-U-Turn Sampler (NUTS), an adaptive variant of the Hamiltonian Monte
Carlo (HMC), algorithm implemented in Stan
(\protect\hyperlink{ref-Carpenter2017}{Carpenter \emph{et al.} 2017})
using the weakly-informative priors
(\protect\hyperlink{ref-Gelman2008}{Gelman \emph{et al.} 2008}). The HMC
algorithm uses gradient information to propose new states in the Markov
chain, leading to a more efficient exploration of the target
distribution than traditional Markov chain Monte Carlo (MCMC) methods
that rely on random proposals
(\protect\hyperlink{ref-Carpenter2017}{Carpenter \emph{et al.} 2017}).
This efficiency allows us to achieve convergence with fewer iterations
compared to traditional MCMC methods. Four independent chains were run
for 2,000 iterations for each model with a warm-up of 1,000 iterations.
Convergence of the posterior distribution was assessed using the
Gelman-Rubin statistic with a convergence threshold of 1.1
(\protect\hyperlink{ref-Gelman2013}{Gelman \emph{et al.} 2013}),
ensuring effective sample sizes grater than 400
(\protect\hyperlink{ref-Vehtari2021}{Vehtari \emph{et al.} 2021}), and
by monitoring divergent transitions
(\protect\hyperlink{ref-Betancourt2016}{Betancourt 2016}) for all
parameters.

All statistical analyses were conducted in R version 4.3.1
(\protect\hyperlink{ref-RCoreTeam2022}{R Core Team 2022}) using the R
package \emph{targets} version 1.3.2 for workflow management
(\protect\hyperlink{ref-Landau2021}{Landau 2021}). Codes and datasets
are available at \url{https://github.com/mattocci27/trait-ndd} and
\url{https://doi.org/10.57760/sciencedb.02276} respectively.

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-Betancourt2016}{}}%
Betancourt, M. (2016).
\href{https://doi.org/10.48550/arXiv.1604.00695}{Diagnosing {Suboptimal
Cotangent Disintegrations} in {Hamiltonian Monte Carlo}}. \emph{arXiv}.

\leavevmode\vadjust pre{\hypertarget{ref-Carpenter2017}{}}%
Carpenter, B., Gelman, A., Hoffman, M.D., Lee, D., Goodrich, B.,
Betancourt, M., \emph{et al.} (2017).
\href{https://doi.org/10.18637/jss.v076.i01}{Stan : {A Probabilistic
Programming Language}}. \emph{Journal of Statistical Software}, 76,
1--32.

\leavevmode\vadjust pre{\hypertarget{ref-Detto2019}{}}%
Detto, M., Visser, M.D., Wright, S.J. \& Pacala, S.W. (2019).
\href{https://doi.org/10.1111/ele.13372}{Bias in the detection of
negative density dependence in plant communities}. \emph{Ecology
Letters}, 22, 1923--1939.

\leavevmode\vadjust pre{\hypertarget{ref-Gelman2013}{}}%
Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A. \&
Rubin, D.B. (2013).
\emph{\href{https://books.google.com.pa/books?id=eSHSBQAAQBAJ}{Bayesian
{Data Analysis}, {Third Edition}}}. {Chapman \& Hall/CRC}, {Boca Raton,
FL, USA.}

\leavevmode\vadjust pre{\hypertarget{ref-Gelman2008}{}}%
Gelman, A., Jakulin, A., Pittau, M.G. \& Su, Y.S. (2008).
\href{https://doi.org/10.1214/08-AOAS191}{A weakly informative default
prior distribution for logistic and other regression models}.
\emph{Annals of Applied Statistics}, 2, 1360--1383.

\leavevmode\vadjust pre{\hypertarget{ref-Landau2021}{}}%
Landau, W.M. (2021). \href{https://doi.org/10.21105/joss.02959}{The
targets {R} package: A dynamic {Make-like} function-oriented pipeline
toolkit for reproducibility and high-performance computing}.
\emph{Journal of Open Source Software}, 6, 2959.

\leavevmode\vadjust pre{\hypertarget{ref-RCoreTeam2022}{}}%
R Core Team. (2022). \emph{\href{https://www.R-project.org/}{R: {A}
language and environment for statistical computing}}. manual. {R
Foundation for Statistical Computing}, {Vienna, Austria}.

\leavevmode\vadjust pre{\hypertarget{ref-Vehtari2021}{}}%
Vehtari, A., Gelman, A., Simpson, D., Carpenter, B. \& Bürkner, P.-C.
(2021). \href{https://doi.org/10.1214/20-BA1221}{Rank-{Normalization},
{Folding}, and {Localization}: {An Improved Rˆ} for {Assessing
Convergence} of {MCMC} (with {Discussion})}. \emph{Bayesian Analysis},
16, 667--718.

\end{CSLReferences}



\end{document}
